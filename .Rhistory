legacy = TRUE)
library("TCGAbiolinks")
library("limma")
library("edgeR")
library("glmnet")
library("factoextra")
library("FactoMineR")
library("caret")
library("SummarizedExperiment")
library("gplots")
library("survival")
library("survminer")
library("RColorBrewer")
library("gProfileR")
library("genefilter")
# rm(assay.list)
#
# getwd()
#
query <- GDCquery(project = "TCGA-GBM",
data.category = "Gene expression",
data.type = "Gene expression quantification",
platform = "Illumina HiSeq",
file.type  = "normalized_results",
experimental.strategy = "RNA-Seq",
barcode = c("TCGA-14-0736-02A-01R-2005-01", "TCGA-06-0211-02A-02R-2005-01"),
legacy = TRUE)
query <- GDCquery(project = "TCGA-GBM",
data.category = "Gene expression",
data.type = "Gene expression quantification",
platform = "Illumina HiSeq",
file.type  = "normalized_results",
experimental.strategy = "RNA-Seq",
barcode = c("TCGA-14-0736-02A-01R-2005-01", "TCGA-06-0211-02A-02R-2005-01"),
legacy = TRUE)
query <- GDCquery(project = "TCGA-GBM",
data.category = "Gene expression",
data.type = "Gene expression quantification",
platform = "Illumina HiSeq",
file.type  = "normalized_results",
experimental.strategy = "RNA-Seq",
barcode = c("TCGA-14-0736-02A-01R-2005-01", "TCGA-06-0211-02A-02R-2005-01"),
legacy = TRUE)
GDCdownload(query)
z <- GDCprepare(query)
dim(z)
summary(z)
z
rm(query)
rm(z)
rm(assay.list)
query_TCGA = GDCquery(project = "TCGA-SKCM",
data.category = "Transcriptome Profiling",
workflow.type = "STAR - Counts",
data.type = "Gene Expression Quantification")
GDCdownload(
query_TCGA,
token.file,
method = "api",
directory = "GDCdata",
files.per.chunk = NULL
)
tcga_data <- GDCprepare(query=query_TCGA, summarizedExperiment = TRUE)
getwd()
sessionInfo()
pca_mir<-PCA(skcm[,colnames(skcm)%in%mir_cols])
library(FactoMineR)
library(factoextra)
pca_mir<-PCA(skcm[,colnames(skcm)%in%mir_cols])
skcm<-readRDS("SKCM.rds")
pca_mir<-PCA(skcm[,colnames(skcm)%in%mir_cols])
meta_cols <- grep(pattern = "^meta", colnames(skcm), value = T)
mir_cols <- grep(pattern = "^hsa", colnames(skcm), value = T)
gene_cols <- grep(pattern = "^(?!meta|hsa)", colnames(skcm), value = T, perl = T)
skcm <- as.data.frame(skcm)
pca_mir<-PCA(skcm[,colnames(skcm)%in%mir_cols])
p<-fviz_pca_ind(pca_mir,col.ind = skcm$meta.RNAseq.classification)
p
imm_genes<-grep("CD4|CD8A|ITGAM|ITGAX|CD3E|CD3G|CD274|PDCD1|TGFB1|KLRG1|TCF1|TOX2|LAG3|HAVCR|TIMD3|IFIT1|IFIT2|JAK1|JAK2|STAT1|STAT3|STAT2|STAT5|MAPK14|PIK3CA",gene_cols,value = T,ignore.case = T)
pca_imm<-PCA(skcm[,imm_genes])
p<-fviz_pca_ind(imm_genes,col.ind = skcm$meta.RNAseq.classification)
p<-fviz_pca_ind(imm_genes,col.ind =skcm$meta.RNAseq.classification)
p<-fviz_pca_ind(pca_mir,col.ind = skcm$meta.RNAseq.classification)
p
knitr::opts_chunk$set(echo = TRUE)
library("TCGAbiolinks")
library("limma")
library("edgeR")
library("glmnet")
library("factoextra")
library("FactoMineR")
library("caret")
library("SummarizedExperiment")
library("gplots")
library("survival")
library("survminer")
library("RColorBrewer")
library("gProfileR")
library("genefilter")
query_TCGA = GDCquery(project = "TCGA-SKCM",
data.category = "Transcriptome Profiling",
workflow.type = "STAR - Counts",
data.type = "Gene Expression Quantification")
GDCdownload(
query_TCGA,
token.file,
method = "api",
directory = "GDCdata",
files.per.chunk = NULL
)
GDCdownload(
query_TCGA,
token.file,
method = "api",
directory = "GDCdata",
files.per.chunk = 60
)
GDCdownload(
query_TCGA,
token.file,
method = "api",
directory = "GDCdata",
files.per.chunk = NULL
)
GDCdownload(
query_TCGA,
token.file,
method = "api",
directory = "GDCdata",
files.per.chunk = NULL
)
tcga_data <- GDCprepare(query=query_TCGA)
setwd("C:/IYTE/Masters Thesis/R/projects/TCGA/data/01_skcm_analysis/GDCdata")
tcga_data <- GDCprepare(query=query_TCGA)
tcga_data <- GDCprepare(query)
tcga_data <- GDCprepare(query_TCGA)
setwd("C:/IYTE/Masters Thesis/R/projects/TCGA/data/01_skcm_analysis")
tcga_data <- GDCprepare(query_TCGA)
GDCdownload(
query_TCGA,
token.file,
method = "api",
directory = "GDCdata",
files.per.chunk = NULL
)
tcga_data <- GDCprepare(query_TCGA)
library("readr")
problems("tcga_data")
stop_for_problems("tcga_data")
tcga_data <- GDCprepare(query_TCGA)
problems("query_TCGA")
stop_for_problems("query_TCGA")
tcga_data <- GDCprepare(query_TCGA)
problems("query_TCGA")
stop_for_problems("query_TCGA")
problems(query_TCGA=.Last.value)
problems("query_TCGA"=.Last.value)
query <- GDCquery(
project = "TCGA-SKCM",
data.category = "Transcriptome Profiling",
workflow.type = "STAR - Counts",
data.type = "Gene Expression Quantification")
rm(query_TCGA)
GDCdownload(
query,
method = "api",
files.per.chunk = 10
)
tcga_data <- GDCprepare(query)
problems("query"=.Last.value)
stop_for_problems("query_TCGA")
tcga_data <- GDCprepare(query)
tcga_data <- GDCprepare(query,summarizedExperiment = F)
tcga_data <- GDCprepare(query,summarizedExperiment = T)
BiocManager::install("BioinformaticsFMRP/TCGAbiolinks")
library(BiocManager)
library(abind)
detach("package:abind", unload = TRUE)
install.packages(c("bookdown", "glmnet", "haven", "vctrs", "zoo"))
install.packages(c("bookdown", "glmnet", "haven", "vctrs", "zoo"))
install.packages(c("bookdown", "glmnet", "haven", "vctrs", "zoo"))
knitr::opts_chunk$set(echo = TRUE)
BiocManager::install("BioinformaticsFMRP/TCGAbiolinks")
tcga_data <- GDCprepare(query)
library("TCGAbiolinks")
library("limma")
library("edgeR")
library("glmnet")
library("factoextra")
library("FactoMineR")
library("caret")
library("SummarizedExperiment")
library("gplots")
library("survival")
library("survminer")
library("RColorBrewer")
library("gProfileR")
library("genefilter")
tcga_data <- GDCprepare(query)
if (!require("BiocManager", quietly = TRUE))
install.packages("BiocManager")
# The following initializes usage of Bioc devel
BiocManager::install(version='devel')
install.packages("BiocManager")
install.packages("BiocManager")
BiocManager::install("TCGAbiolinks")
BiocManager::install("TCGAbiolinks")
sessionInfo()
updateR()
require(installr)
updateR()
updateR()
BiocManager::install("TCGAbiolinks")
update.packages(TCGAbiolinks)
update.packages("TCGAbiolinks")
knitr::opts_chunk$set(echo = TRUE)
BiocManager::install("BioinformaticsFMRP/TCGAbiolinksGUI.data")
install.packages("BiocManager")
install.packages("BiocManager")
knitr::opts_chunk$set(echo = TRUE)
BiocManager::install("BioinformaticsFMRP/TCGAbiolinksGUI.data")
BiocManager::install("BioinformaticsFMRP/TCGAbiolinks")
install.packages("remotes")
install.packages("BiocManager")
install.packages("BiocManager")
knitr::opts_chunk$set(echo = TRUE)
BiocManager::install("BioinformaticsFMRP/TCGAbiolinksGUI.data")
BiocManager::install("BioinformaticsFMRP/TCGAbiolinksGUI.data")
BiocManager::install("BioinformaticsFMRP/TCGAbiolinks")
tcga_data <- GDCprepare(query)
library("TCGAbiolinks")
library("TCGAbiolinks")
knitr::opts_chunk$set(echo = TRUE)
library("TCGAbiolinks")
library("limma")
library("edgeR")
library("glmnet")
library("factoextra")
library("FactoMineR")
library("caret")
library("SummarizedExperiment")
library("gplots")
library("survival")
library("survminer")
library("RColorBrewer")
library("gProfileR")
library("genefilter")
tcga_data <- GDCprepare(query)
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(echo = TRUE)
library("TCGAbiolinks")
library("limma")
library("edgeR")
library("glmnet")
library("factoextra")
library("FactoMineR")
library("caret")
library("SummarizedExperiment")
library("gplots")
library("survival")
library("survminer")
library("RColorBrewer")
library("gProfileR")
library("genefilter")
dim(tcga_data)
tcga_data
colnames(colData(tcga_data))
head(colnames(colData(tcga_data)))
tail(rownames(rowData(tcga_data)))
dim(tcga_data)
assays(tcga_data)
View(tcga_data)
table(tcga_data@colData$vital_status)
table(tcga_data@colData$tumor_stage)
dim(assay(tcga_data))
head(assay(tcga_data)[,1:10])
head(assay(tcga_data)[,1:10])
table(tcga_data@colData$gender)
View(tcga_data)
table(tcga_data@colData$tumor_stage)
table(tcga_data@colData$age_at_diagnosis)
table(tcga_data@colData$age_at_index)
saveRDS(object = tcga_data,
file = "tcga_data.RDS",
compress = FALSE)
rm(tcga_data)
tcga_data = readRDS(file = "tcga_data.RDS")
limma_pipeline = function(
tcga_data,
condition_variable,
reference_group=NULL){
design_factor = colData(tcga_data)[, condition_variable, drop=T]
group = factor(design_factor)
if(!is.null(reference_group)){group = relevel(group, ref=reference_group)}
design = model.matrix(~ group)
dge = DGEList(counts=assay(tcga_data),
samples=colData(tcga_data),
genes=as.data.frame(rowData(tcga_data)))
# filtering
keep = filterByExpr(dge,design)
dge = dge[keep,,keep.lib.sizes=FALSE]
rm(keep)
# Normalization (TMM followed by voom)
dge = calcNormFactors(dge)
v = voom(dge, design, plot=TRUE)
# Fit model to data given design
fit = lmFit(v, design)
fit = eBayes(fit)
# Show top genes
topGenes = topTable(fit, coef=ncol(design), number=100, sort.by="p")
return(
list(
voomObj=v, # normalized data
fit=fit, # fitted model and statistics
topGenes=topGenes # the 100 most differentially expressed genes
)
)
}
View(limma_pipeline)
View(limma_pipeline)
View(limma_pipeline)
function(
tcga_data,
condition_variable,
reference_group=NULL){
design_factor = colData(tcga_data)[, condition_variable, drop=T]
group = factor(design_factor)
if(!is.null(reference_group)){group = relevel(group, ref=reference_group)}
design = model.matrix(~ group)
dge = DGEList(counts=assay(tcga_data),
samples=colData(tcga_data),
genes=as.data.frame(rowData(tcga_data)))
# filtering
keep = filterByExpr(dge,design)
dge = dge[keep,,keep.lib.sizes=FALSE]
rm(keep)
# Normalization (TMM followed by voom)
dge = calcNormFactors(dge)
v = voom(dge, design, plot=TRUE)
# Fit model to data given design
fit = lmFit(v, design)
fit = eBayes(fit)
# Show top genes
topGenes = topTable(fit, coef=ncol(design), number=100, sort.by="p")
return(
list(
voomObj=v, # normalized data
fit=fit, # fitted model and statistics
topGenes=topGenes # the 100 most differentially expressed genes
)
)
}
View(limma_pipeline)
limma_pipeline(tcga_data)
limma_pipeline("tcga_data")
limma_res = limma_pipeline(
tcga_data=tcga_data,
condition_variable="",
reference_group=""
)
gender_limma_res = limma_pipeline(
tcga_data=tcga_data,
condition_variable="gender",
reference_group="female"
)
View(gender_limma_res)
limma_res = limma_pipeline(
tcga_data=tcga_data,
condition_variable="",
reference_group=""
)
limma_res = limma_pipeline(
tcga_data=tcga_data,
condition_variable="sample_type",
reference_group="Metastatic"
)
gender_limma_res = limma_pipeline(
tcga_data=tcga_data,
condition_variable="gender",
reference_group="female"
)
saveRDS(object = limma_res,
file = "limma_res.RDS",
compress = FALSE)
clinical_data = colData(tcga_data)
group = factor(clinical_data$definition)
group = relevel(group, ref="Solid Tissue Normal")
View(clinical_data)
group
sum(group)
summary(group)
design = model.matrix(~group)
head(design)
View(design)
dge = DGEList( # creating a DGEList object
counts=assay(tcga_data),
samples=colData(tcga_data),
genes=as.data.frame(rowData(tcga_data)))
# filtering
keep = filterByExpr(dge,design) # defining which genes to keep
dge = dge[keep,,keep.lib.sizes=FALSE] # filtering the dge object
rm(keep) #  use rm() to remove objects from memory if you don't need them anymore
View(dge)
dge = calcNormFactors(dge,method="TMM")
v = voom(dge,design,plot=TRUE)
fit = lmFit(v, design)
fit = eBayes(fit)
topGenes = topTable(fit, coef=1, sort.by="p")
print(topGenes)
View(topGenes)
View(v)
knitr::opts_chunk$set(echo = TRUE)
dim(tcga_data)
lihc_res = getResults(query_TCGA)
library("TCGAbiolinks")
library("limma")
library("edgeR")
library("glmnet")
library("factoextra")
library("FactoMineR")
library("caret")
library("SummarizedExperiment")
library("gplots")
library("survival")
library("survminer")
library("RColorBrewer")
library("gProfileR")
library("genefilter")
lihc_res = getResults(query_TCGA)
query_TCGA = GDCquery(project = "TCGA-SKCM",
data.category = "Transcriptome Profiling",
experimental.strategy = "RNA-Seq",
workflow.type = "STAR - Counts")
lihc_res = getResults(query_TCGA)
View(lihc_res)
rm(lihc_res)
rm(query_TCGA)
sessionInfo()
IBDSKCM <- readRDS("C:/IYTE/Masters Thesis/R/projects/TCGA/r_scripts/IBDSKCM.rds")
View(IBDSKCM)
knitr::opts_chunk$set(echo = TRUE)
library("TCGAbiolinks")
library("limma")
library("edgeR")
library("glmnet")
library("factoextra")
library("FactoMineR")
library("caret")
library("SummarizedExperiment")
library("gplots")
library("survival")
library("survminer")
library("RColorBrewer")
library("gProfileR")
library("genefilter")
TCGAbiolinks:::getProjectSummary("TCGA-SKCM")
library("TCGAbiolinks")
library("limma")
library("edgeR")
library("glmnet")
library("factoextra")
library("FactoMineR")
library("caret")
library("SummarizedExperiment")
library("gplots")
library("survival")
library("survminer")
library("RColorBrewer")
library("gProfileR")
library("genefilter")
tcga_data <- readRDS("C:/IYTE/Masters Thesis/R/projects/TCGA/01_skcm_analyses/tcga_data.RDS")
tcga_data = readRDS(file = "tcga_data.RDS")
tcga_data <- readRDS("C:/IYTE/Masters Thesis/R/projects/TCGA/01_skcm_analyses/tcga_data.RDS")
dim(tcga_data)
limma_res <- readRDS("C:/IYTE/Masters Thesis/R/projects/TCGA/01_skcm_analyses/limma_res.RDS")
tcga_data <- readRDS("C:/IYTE/Masters Thesis/R/projects/TCGA/01_skcm_analyses/tcga_data.RDS")
tcga_data <- readRDS("C:/IYTE/Masters Thesis/R/projects/TCGA/01_skcm_analyses/tcga_data.RDS")
IBDSKCM <- readRDS("C:/IYTE/Masters Thesis/R/projects/TCGA/r_scripts/IBDSKCM.rds")
knitr::opts_chunk$set(echo = TRUE)
clin <- GDCquery_clinic("TCGA-SKCM", type = "clinical", save.csv = F)
library("TCGAbiolinks")
library("limma")
library("edgeR")
library("glmnet")
library("factoextra")
library("FactoMineR")
library("caret")
library("SummarizedExperiment")
library("gplots")
library("survival")
library("survminer")
library("RColorBrewer")
library("gProfileR")
library("genefilter")
clin <- GDCquery_clinic("TCGA-SKCM", type = "clinical", save.csv = F)
View(clin)
TCGAbiolinks:::getProjectSummary("TCGA-SKCM")
knitr::opts_chunk$set(echo = TRUE)
query_miRNA <- GDCquery(
project = "TCGA-SKCM")
query_miRNA <- GDCquery(
project = "TCGA-SKCM",
data.category = "Transcriptome Profiling")
View(query_miRNA)
View(query_miRNA[[1]][[1]])
query_miRNA$data.type
query_clinical <- GDCquery(
project = "TCGA-SKCM",
data.category = "Clinical",
)
View(query_clinical)
View(query_clinical[[1]][[1]])
